{% extends 'base.html' %}

{% block title %}Корзина | Ganich Beauty{% endblock %}

{% block content %}
<h2 style="text-align: center; margin: 2rem 0;">Ваша корзина</h2>

{% if cart_items %}
  <div style="max-width: 800px; margin: 0 auto;">
    {% for item in cart_items %}
      <div class="card" style="padding: 1.2rem; margin-bottom: 1rem; display: flex; gap: 1rem;">
        <div style="flex: 0 0 100px; height: 100px; background:#f5f5f5; border-radius: 4px; overflow:hidden;">
          {% if item.product.images.all %}
            <img src="{{ item.product.images.first.image.url }}" alt="{{ item.product.name }}" style="width:100%; height:100%; object-fit:cover;">
          {% else %}
            <div style="height:100%; display:flex; align-items:center; justify-content:center; background:#eee;">?</div>
          {% endif %}
        </div>

        <div style="flex: 1;">
          <h3>{{ item.product.name }}</h3>
          <p>{{ item.product.price }} ₽ × {{ item.quantity }}</p>
          <form method="POST" action="{% url 'maingb:remove_from_cart' item.id %}" style="margin-top: 0.5rem;">
            {% csrf_token %}
            <button type="submit" class="btn btn-outline" style="padding: 4px 8px; font-size:0.9rem;">Удалить</button>
          </form>
        </div>

        <div style="font-weight: bold; font-size: 1.2rem; color: var(--pink-dark);">
          {{ item.product.price|floatformat:2 }} ₽
        </div>
      </div>
    {% endfor %}

    <div style="border-top: 1px solid #eee; padding-top: 1.5rem; margin-top: 1.5rem;">
      <div style="display: flex; justify-content: space-between; font-size: 1.2rem; font-weight: 600;">
        <span>Итого:</span>
        <span>{{ total|floatformat:2 }} ₽</span>
      </div>
      <button class="btn btn-primary" style="margin-top: 1.5rem; width: 100%; padding: 12px;">
        Оформить заказ
      </button>
    </div>
  </div>
{% else %}
  <div style="text-align: center; padding: 4rem 1rem; color: #777;">
    <p>Корзина пуста.</p>
    <a href="{% url 'maingb:product_list' %}" class="btn btn-primary" style="margin-top: 1rem;">
      Перейти к товарам
    </a>
  </div>
{% endif %}
{% endblock %}